pipeline {

  agent {

    docker {

      image 'windsekirun/jenkins-android-docker:1.1.1'

    }

  }

  options {

       skipStagesAfterUnstable()

  }

  stages {

    stage ('PREPARE'){

      steps {

        sh 'chmod +x ./gradlew'

      }

    }

    stage('COMPILE') {

      steps {

        sh './gradlew compileDebugSources'

      }

    }

    stage('UNIT TEST') {

      steps {
        
        sh './gradlew testDebugUnitTest testDebugUnitTest'
  
        junit '**/TEST-*.xml'

      }

    }

    stage('Build APPLICATION') {

      steps {
      
        sh './gradlew assembleDebug'

      }

    }

  }

}
